{% extends "base.html" %}

{% block title %}Filichkin Bogdan{% endblock %}


{% block navigation %}
<a href="{{ url_for('comments') }}">Комментарии</a>
{% endblock %}

{% block auth_buttons %}
<a href="{{ url_for('social_login') }}" class="social-login-btn social-main">
    <i class="fas fa-sign-in-alt"></i>
    <span>Login</span>
</a>
{% endblock %}

{% block side_icons %}
<div class="side-icons visible" id="side-icons">
    <a href="https://github.com/Bogban893" target="_blank" class="side-icon github pulse" data-tooltip="Мой GitHub">
        <img src="{{ url_for('static', filename='images/github-logo.gif') }}" alt="GitHub">
    </a>
    <a href="https://t.me/Bogdan4ky" target="_blank" class="side-icon telegram" data-tooltip="Telegram">
        <img src="{{ url_for('static', filename='images/telegram.gif') }}" alt="Telegram">
    </a>
</div>
{% endblock %}

{% block content %}
<div class="container">
    <div class="card">
        <div class="photo-container">
            <!-- Изменено: id для фото, чтобы можно было обновлять через JS -->
            <img id="profile-photo" src="{{ url_for('static', filename='images/me.png') }}" alt="Фото Filichkin Bogdan"
                class="photo" width="200" height="200">
        </div>
        <div class="card-content">
            <h1 id="animated-name">Филичкин Богдан</h1>
            <p>Студент Программной Инженерии СПбГУ</p>
        </div>
    </div>
</div>

<div class="container">
    <div class="additional-content">
        <h2>Обо мне</h2>
        <p>
            Привет! Я Богдан, студент Программной Инженерии в СПбГУ. Увлекаюсь системным программированием.
            На этом сайте я делюсь своими проектами и мыслями. Люблю готовить и играть в видеоигры. Обожаю животных,
            особенно кошек! (=^･ω･^=)∫
        </p>
    </div>
</div>

<div class="content">
    <div class="page-header">
        <h1>Мои творения</h1>
    </div>

    <div class="page-content">
        <div class="info-section">
            <h2><i class="fas fa-code"></i> Мои проекты</h2>
            <div class="projects-grid">
                <a href="https://github.com/spbu-coding-2024/graphs-graphs-team-9" target="_blank"
                    rel="noopener noreferrer" class="project-card">
                    <h3>Анализ графов</h3>
                    <p>Десктопное приложение для создания, визуализации и анализа графов</p>
                    <span class="tech-tag">Kotlin</span>
                    <span class="tech-tag">Jetpack Compose for Desktop</span>
                </a>

                <a href="/" target="_blank" rel="noopener noreferrer" class="project-card">
                    <h3>Эта страничка =^_^= </h3>
                    <p>Мой личный сайт с системой комментариев и авторизацией</p>
                    <span class="tech-tag">Python</span>
                    <span class="tech-tag">Flask</span>
                    <span class="tech-tag">SQLite</span>
                    <span class="tech-tag">CSS</span>
                </a>
            </div>
        </div>

        <div class="separator"></div>

        <div class="info-section">
            <h2><i class="fas fa-graduation-cap"></i> Навыки</h2>
            <div class="skills-list">
                <span class="skill">Python</span>
                <span class="skill">Flask</span>
                <span class="skill">HTML/CSS</span>
                <span class="skill">SQL</span>
                <span class="skill">Git</span>
                <span class="skill">Docker</span>
                <span class="skill">Kotlin</span>
                <span class="skill">C</span>

            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<style>
    .page-header {
        margin-bottom: 40px;
        text-align: center;
        margin-top: 40px;
    }

    .page-subtitle {
        color: #bbb;
        font-size: 18px;
        margin-top: 10px;
    }

    .page-content {
        background: #1a1a1a;
        padding: 30px;
        border-radius: 12px;
        margin-bottom: 30px;
    }

    .info-section {
        margin-bottom: 30px;
    }

    .info-section h2 {
        color: #4a90e2;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .projects-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .project-card {
        background: #222;
        padding: 20px;
        border-radius: 10px;
        border-left: 4px solid rgba(74, 144, 226, 0.5);
    }

    .project-card h3 {
        color: #fff;
        margin-bottom: 10px;
    }

    .tech-tag {
        display: inline-block;
        background: rgba(74, 144, 226, 0.1);
        color: #4a90e2;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 12px;
        margin-right: 8px;
        margin-top: 10px;
    }

    .skills-list {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }

    .skill {
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 14px;
        transition: all 0.3s;
    }

    .skill:hover {
        background: rgba(74, 144, 226, 0.2);
        transform: translateY(-2px);
    }

    .separator {
        height: 1px;
        background: linear-gradient(90deg, transparent, rgba(255, 68, 68, 0.2), transparent);
        margin: 30px 0;
    }
</style>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const nameElement = document.getElementById('animated-name');
        if (nameElement) {
            const nameText = nameElement.textContent;
            const nameContainer = document.createElement('span');
            nameContainer.className = 'name-container';
            nameElement.innerHTML = '';
            nameElement.appendChild(nameContainer);

            for (let i = 0; i < nameText.length; i++) {
                const char = nameText[i];
                let span;

                if (char === ' ') {
                    span = document.createElement('span');
                    span.className = 'falling-space';
                    span.innerHTML = '&nbsp;';
                } else {
                    span = document.createElement('span');
                    span.className = 'falling-letter';
                    span.textContent = char;
                    span.style.animationDelay = `${i * 0.1}s`;
                }
                nameContainer.appendChild(span);
            }
        }

        // Смена аватарки при зажатии
        const photo = document.getElementById('profile-photo');
        if (photo) {
            // Массив ВСЕХ доступных фото (включая исходное)
            // Убедитесь, что все эти файлы действительно существуют в папке static/images/
            const avatars = [
                "{{ url_for('static', filename='images/me.png') }}",   // 1-е альтернативное
                "{{ url_for('static', filename='images/me_1.png') }}", // 2-е альтернативное
                "{{ url_for('static', filename='images/me_2.png') }}"  // 3-е альтернативное
            ];

            // Проверяем массив на пустые значения
            console.log("Доступные фото:", avatars);

            // Убираем пустые элементы из массива
            const filteredAvatars = avatars.filter(avatar => avatar && avatar.trim() !== '');

            if (filteredAvatars.length === 0) {
                console.error("Нет доступных фото!");
                return;
            }

            // Текущий индекс в массиве
            let currentAvatarIndex = 0;
            let isMouseDown = false;
            let mouseDownTimer = null;
            let changeInterval = null;

            // Функция для смены фото
            function changePhoto() {
                // Проверяем, есть ли фото в массиве
                if (filteredAvatars.length === 0) return;

                // Переходим к следующему фото по кругу
                currentAvatarIndex = (currentAvatarIndex + 1) % filteredAvatars.length;

                // Обновляем фото
                photo.src = filteredAvatars[currentAvatarIndex];
                console.log(`Текущее фото: ${currentAvatarIndex} - ${filteredAvatars[currentAvatarIndex]}`);
            }

            // Обработчик зажатия мыши
            photo.addEventListener('mousedown', function (e) {
                e.preventDefault();
                isMouseDown = true;

                // Начинаем смену фото после небольшой задержки
                mouseDownTimer = setTimeout(() => {
                    if (isMouseDown && filteredAvatars.length > 1) {
                        // Меняем на следующее фото
                        changePhoto();

                        // Устанавливаем интервал для автоматической смены
                        changeInterval = setInterval(() => {
                            if (isMouseDown && filteredAvatars.length > 1) {
                                changePhoto();
                            } else if (!isMouseDown) {
                                clearInterval(changeInterval);
                                changeInterval = null;
                            }
                        }, 500);
                    }
                }, 100);
            });

            // Для мобильных устройств
            photo.addEventListener('touchstart', function (e) {
                e.preventDefault();
                isMouseDown = true;

                mouseDownTimer = setTimeout(() => {
                    if (isMouseDown && filteredAvatars.length > 1) {
                        changePhoto();

                        changeInterval = setInterval(() => {
                            if (isMouseDown && filteredAvatars.length > 1) {
                                changePhoto();
                            } else if (!isMouseDown) {
                                clearInterval(changeInterval);
                                changeInterval = null;
                            }
                        }, 500);
                    }
                }, 100);
            });

            // Останавливаем смену при отпускании
            function stopChanging() {
                isMouseDown = false;
                clearTimeout(mouseDownTimer);
                if (changeInterval) {
                    clearInterval(changeInterval);
                    changeInterval = null;
                }
            }

            // События для остановки
            photo.addEventListener('mouseup', stopChanging);
            photo.addEventListener('mouseleave', stopChanging);
            photo.addEventListener('touchend', stopChanging);
            photo.addEventListener('touchcancel', stopChanging);

            // Быстрый клик для смены на следующее фото
            photo.addEventListener('click', function (e) {
                // Проверяем, не было ли это частью долгого зажатия
                if (!isMouseDown && !changeInterval && filteredAvatars.length > 1) {
                    changePhoto();
                }
            });

            // Дебаг информация
            console.log(`Всего фото: ${filteredAvatars.length}`);
            console.log(`Первое фото: ${filteredAvatars[0]}`);
        }
    });
</script>
{% endblock %}